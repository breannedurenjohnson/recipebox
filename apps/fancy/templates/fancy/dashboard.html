<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <title>Dashboard</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'fancy/css/style.css' %}">
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){
            $('.card').mouseenter(function(){
                $(this).css('background-color', '#fde0e7');
            });
            $('.card').mouseleave(function(){
                $(this).css('background-color', 'white')});
            $('.btn-link').hover(function(){
                $(this).css('color', 'white'),
                $(this).css('text-decoration', 'none')});     
        
        //  ATTEMPTED AJAX TO ADD AND REMOVE RECIPES WITHOUT A REFRESH
        // $('form').submit(function(e){
        //     e.preventDefault()
        //     str = e['target']['action']
        //     console.log(str)
        //     str = str.substring(22, str.length)
        //     console.log(str)
        //     $.ajax({
        //         url: str,
        //         method: 'post',
        //         data: $(this).serialize(),
        //         success: function(serverResponse){
        //             console.log(serverResponse)
        //             $('.like').html(serverResponse)
        //             $('.unlike').html(serverResponse)
        //         }
        //     })
        // })
    });
    </script>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="#">Hello, {{user_name}}!</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarText">
            <ul class="navbar-nav mr-auto">
                <li><a class="nav-item active" href="/user/{{user_id}}">Your Recipe Box</a></li>
            </ul>
            <span><a class="nav-link" href="/logout">Log Out</a></span>
        </div>
    </nav>
    <div class="container">
        <div class="logo"><img src="{% static 'fancy/images/logo.png' %}" alt="logo"></div>
        {% for recipe in all_recipes %}
        <div class="card" style="width: 250px;">
            <a href = "/recipes/{{recipe.id}}"><img src="{{ recipe.photo.url }}" alt="{{ recipe.title }}"></a>
            <div class="card-body">
                <h5 class="card-title">{{ recipe.title }}</h5>
                <div class="like">
                    {% if recipe in unliked_recipes %}
                    <form action="/recipes/{{recipe.id}}/like" method="post">{% csrf_token %}<button type="submit" class='btn btn-link shadow-none'>â™¥ Add to Recipe Box</button></form>
                    {% endif %}
                </div>
                <div class="unlike">
                    {% if recipe in liked_recipes %}
                    <form action="/recipes/{{recipe.id}}/unlike" method="post">{% csrf_token %}<button type="submit" class='btn btn-light shadow-none'>Remove from Recipe Box</button></form>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    <div class="footer">
        <img src="{% static 'fancy/images/twitter.png' %}" alt="twitter">
        <img src="{% static 'fancy/images/instagram.png' %}" alt="instagram">
        <img src="{% static 'fancy/images/facebook.png' %}" alt="facebook">
        <img src="{% static 'fancy/images/pinterest.jpg' %}" alt="pinterest">
    </div>
</body>
</html>